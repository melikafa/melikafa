<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Ø¬Ø²Ø¦ÛŒØ§Øª Ù…Ø­ØµÙˆÙ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    body { font-family:"Yekan Bakh"; background:#f5f7fa; }
    .main-card{ max-width:800px; margin:2rem auto; border-radius:16px; }
    .product-img{ width:100%; height:300px; object-fit:cover; border-radius:12px; }
    .similar-card img{ height:160px; object-fit:cover; border-radius:12px; }
    .carousel-item > .d-flex { gap:1rem; justify-content:center; flex-wrap:nowrap; overflow-x:auto; }
    .carousel-item > .d-flex > div { min-width:200px; flex:0 0 auto; }
  </style>
</head>
<body>

<div class="card shadow-sm p-3 main-card">
  <img id="img" class="product-img mb-3" src="">
  <h4 id="name"></h4>
  <p id="desc" class="text-muted"></p>
  <div id="meta" class="small mb-2"></div>
  <div id="price" class="fw-bold text-primary mb-3"></div>

  <div class="d-flex gap-2">
    <button class="btn btn-primary flex-fill" data-bs-toggle="modal" data-bs-target="#inquiryModal">
      Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø³ØªØ¹Ù„Ø§Ù…
    </button>
    <a href="allproducts.html" class="btn btn-outline-secondary flex-fill">Ø¨Ø§Ø²Ú¯Ø´Øª</a>
  </div>
</div>

<!-- Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡ -->
<div class="container mt-5">
  <h5 class="mb-3 text-center">Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡</h5>
  <div id="similarCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner" id="similarItems"></div>
    <button class="carousel-control-prev" type="button"
            data-bs-target="#similarCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button"
            data-bs-target="#similarCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ø³ØªØ¹Ù„Ø§Ù… -->
<div class="modal fade" id="inquiryModal">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø³ØªØ¹Ù„Ø§Ù…</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input class="form-control mb-2" id="inqProduct" readonly>
        <input class="form-control mb-2" id="inqName" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
        <input class="form-control" id="inqPhone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary w-100" onclick="submitInquiry()">Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* =========================
   ğŸ”¹ Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª
========================= */
const allProducts = [
  { id:1, name:'Ø±Ø¯ÛŒØ§Ø¨ Ù‡ÙˆØ´Ù…Ù†Ø¯ A1', desc:'Ø±Ø¯ÛŒØ§Ø¨ Ú©ÙˆÚ†Ú© Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ IoT Ø¨Ø§ Ø¨Ø§ØªØ±ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ', category:'ÙÙ†Ø§ÙˆØ±ÛŒ', unit:'ØªÙ‡Ø±Ø§Ù† Ø´Ù…Ø§Ù„', available:true, price:1250000, img:'https://images.pexels.com/photos/244822/pexels-photo-244822.jpeg' },
  { id:2, name:'Ú©ÛŒØª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø±Ùˆ B2', desc:'Ú©ÛŒØª ØªØ´Ø®ÛŒØµ Ø³Ø±ÛŒØ¹ Ù…ÙˆØ§Ø¯ Ø¯Ø§Ø±ÙˆÛŒÛŒ Ùˆ ØªØ±Ú©ÛŒØ¨Ø§Øª', category:'Ø¯Ø§Ø±ÙˆÛŒÛŒ', unit:'ØªÙ‡Ø±Ø§Ù† Ù…Ø±Ú©Ø²', available:false, price:4200000, img:'https://images.pexels.com/photos/159211/headache-pain-pills-medication-159211.jpeg' },
  { id:3, name:'Ø­Ø³Ú¯Ø± Ø±Ø·ÙˆØ¨Øª Ø®Ø§Ú© C3', desc:'Ø­Ø³Ú¯Ø± Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§', category:'Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ', unit:'Ø§ØµÙÙ‡Ø§Ù†', available:true, price:650000, img:'https://images.pexels.com/photos/348689/pexels-photo-348689.jpeg' },
  { id:4, name:'Ù¾Ú©ÛŒØ¬ Ø¨Ø§Ø²ÛŒØ§ÙØª D4', desc:'Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒØ§ÙØª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø³Ù…Ø§Ù†Ø¯ ØµÙ†Ø¹ØªÛŒ', category:'Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª', unit:'Ø§ØµÙÙ‡Ø§Ù†', available:true, price:2850000, img:'https://images.pexels.com/photos/3735218/pexels-photo-3735218.jpeg' },
  { id:5, name:'Ù¾Ù„ØªÙØ±Ù… ÙˆØ¨ E5', desc:'Ø³Ø±ÙˆÛŒØ³ Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø±Ù‡Ø§', category:'ÙÙ†Ø§ÙˆØ±ÛŒ', unit:'ØªÙ‡Ø±Ø§Ù† Ø´Ù…Ø§Ù„', available:false, price:980000, img:'https://images.pexels.com/photos/461073/pexels-photo-461073.jpeg' },
  { id:6, name:'Ù†Ø§Ù†Ùˆ Ù¾ÙˆØ´Ø´ Ø¶Ø¯Ø¢Ø¨ F6', desc:'Ù¾ÙˆØ´Ø´ Ù…Ø­Ø§ÙØ¸ØªÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø·ÙˆØ­ Ùˆ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ø­Ø³Ø§Ø³', category:'Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª', unit:'ØªÙ‡Ø±Ø§Ù† Ù…Ø±Ú©Ø²', available:true, price:1750000, img:'https://images.pexels.com/photos/1826060/pexels-photo-1826060.jpeg' },
  { id:7, name:'Ø­Ø³Ú¯Ø± Ú©ÛŒÙÛŒØª Ù‡ÙˆØ§ G7', desc:'Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ú©ÛŒÙÛŒØª Ù‡ÙˆØ§ Ø¯Ø± Ù…Ø­ÛŒØ·â€ŒÙ‡Ø§ÛŒ Ø´Ù‡Ø±ÛŒ', category:'Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª', unit:'Ø§ØµÙÙ‡Ø§Ù†', available:false, price:1990000, img:'https://images.pexels.com/photos/2539462/pexels-photo-2539462.jpeg' }
];

/* =========================
   ğŸ”¹ Ú¯Ø±ÙØªÙ† id Ø§Ø² URL
========================= */
const params = new URLSearchParams(location.search);
const productId = Number(params.get('id'));
const product = allProducts.find(p => p.id === productId);

if(!product){
  document.body.innerHTML = '<p class="text-center mt-5 text-muted">Ù…Ø­ØµÙˆÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>';
  throw new Error('Product not found');
}

/* =========================
   ğŸ”¹ Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„ Ø§ØµÙ„ÛŒ
========================= */
document.getElementById('img').src = product.img;
document.getElementById('name').textContent = product.name;
document.getElementById('desc').textContent = product.desc;
document.getElementById('meta').textContent = `Ø¯Ø³ØªÙ‡: ${product.category} | ÙˆØ§Ø­Ø¯: ${product.unit}`;
document.getElementById('price').textContent = new Intl.NumberFormat('fa-IR').format(product.price) + ' ØªÙˆÙ…Ø§Ù†';

/* =========================
   ğŸ”¹ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø´Ø§Ø¨Ù‡ (4 Ù…Ø­ØµÙˆÙ„ Ø§ÙÙ‚ÛŒ)
========================= */
function shuffle(arr){ return arr.sort(()=>0.5 - Math.random()); }
const similar = shuffle(allProducts.filter(p => p.id !== product.id)).slice(0, 4);
const similarBox = document.getElementById('similarItems');
similarBox.innerHTML = `
  <div class="carousel-item active">
    <div class="d-flex">
      ${similar.map(p=>`
        <div class="card similar-card p-2">
          <img src="${p.img}" class="w-100 mb-2">
          <div class="fw-bold small">${p.name}</div>
          <div class="text-muted small mb-2">${p.category}</div>
          <a href="product-detail.html?id=${p.id}" class="btn btn-sm btn-outline-primary w-100">Ù…Ø´Ø§Ù‡Ø¯Ù‡</a>
        </div>`).join('')}
    </div>
  </div>
`;

/* =========================
   ğŸ”¹ Ø§Ø³ØªØ¹Ù„Ø§Ù…
========================= */
document.getElementById('inqProduct').value = product.name;
function submitInquiry(){
  const nameVal = document.getElementById('inqName').value.trim();
  const phoneVal = document.getElementById('inqPhone').value.trim();
  if(!nameVal || !phoneVal){ alert('Ù†Ø§Ù… Ùˆ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'); return; }
  alert('âœ… Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´Ù…Ø§ Ø«Ø¨Øª Ø´Ø¯');
  console.log({ product: product.name, name: nameVal, phone: phoneVal });
  bootstrap.Modal.getInstance(document.getElementById('inquiryModal')).hide();
  document.getElementById('inqName').value = '';
  document.getElementById('inqPhone').value = '';
}
</script>

</body>
</html>
